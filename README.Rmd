[![Build Status](https://travis-ci.org/wahani/aoos.png?branch=master)](https://travis-ci.org/wahani/aoos)

# Another object orientation system in R
```{r, results='asis', echo=FALSE}
cat(gsub("\\n   ", "", packageDescription("aoos", fields = "Description")))
```

# Installation
To install from CRAN:
```{r, eval=FALSE}
install.packages("aoos")
```

To install from this repo:
```{r, eval=FALSE}
library(devtools)
install_github("wahani/aoos")
```

```{r, echo=FALSE}
getLocalPackageUpdates <- function(package) {
  ps <- summary(packageStatus())
  cranVersion <- ps$avail[rownames(ps$avail) == package, "Version"]
  localVersion <- ps$inst[rownames(ps$inst) == package, "Version"]
  cat("Version on CRAN:", cranVersion, "\n")
  cat("Development Version:", localVersion, "\n\n")
  cat("Updates in package NEWS-file since last release to CRAN:\n\n")
  print(news(Version > cranVersion, package = package))
  invisible(NULL)
}

getLocalPackageUpdates("aoos")
```

# Example I
This example is adapted from the [R6](https://github.com/wch/R6) package from the [private members example](http://rpubs.com/wch/24456) to have a direct comparison.

```{r}
suppressPackageStartupMessages(library(aoos))

Queue <- defineClass("Queue", {
  
  queue <- list()
  
  add <- publicFunction(function(x) {
      queue <<- c(queue, list(x))
      invisible(self)
    })
  
  remove <- publicFunction(function() {
      if (queueIsEmpty()) return(NULL)
      head <- queue[[1]]
      queue <<- queue[-1]
      head
    })
  
  queueIsEmpty <- function() length(queue) == 0
})

q <- Queue()
q
```

```{r}
q$add(5)
q$add("something")
q$add(17)
q$remove()
q$remove()
q$add(1)$add(2)
q$remove()
q$add(matrix("", ncol = 1000, nrow = 1000))
summary(q)
```

# The use of the self

This example is also adapted from the [R6](https://github.com/wch/R6) package from the [basics example](http://rpubs.com/wch/24456).

If it is desirable you can access all (public and private) members using `self` inside the class definition. Maybe you want to write `self$privateMember <- 1` instead of `privateMember <<- 1`...

```{r}
Person <- defineClass("Person", {
    name <- NA
    hair <- NA
    
    set <- publicFunction(function(name, hair) {
      if(!missing(name)) self$name <- name
      if(!missing(hair)) self$hair <- hair
      self$greet()
      invisible(self)
    })
    
    greet = function() {
      cat(paste0("Hello, my name is ", self$name, ".\n"))
    }
})

ann <- Person()
ann$set("Ann", "")

```

If you return `self` as in the `set` function -- `self` and the `ann` are both pointing to the same object -- you can chain method calls.

```{r}
identical(ann, ann$set("not Ann"))
ann$set()$set()
```

